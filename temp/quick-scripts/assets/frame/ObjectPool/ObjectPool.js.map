{"version":3,"sources":["ObjectPool.ts"],"names":[],"mappings":";;;;;AAUA;IAMI;;;OAGG;IACH,oBAAY,GAAmB;QAAnB,oBAAA,EAAA,WAAmB;QAT/B,WAAM,GAAK,EAAE,CAAA;QACb;;WAEG;QACH,QAAG,GAAW,KAAK,CAAA;QAOf,IAAI,CAAC,GAAG,GAAC,GAAG,CAAA;IAChB,CAAC;IACD,kCAAa,GAAb,UAAc,CAAK;QAEf,IAAG,CAAC,CAAC,aAAa,CAAC,EACnB;YACI,IAAG,CAAC,CAAC,OAAO,CAAC;gBAAC,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC;SAC9B;aAED;YACI,CAAC,CAAC,aAAa,CAAC,GAAC,IAAI,CAAC;SACzB;IACL,CAAC;IACD,kCAAa,GAAb,UAAc,EAAM,EAAC,UAAgB;QAEjC,IAAG,EAAE,IAAE,EAAE,CAAC,OAAO,CAAC;YAAC,EAAE,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,EAAE,EAAC,UAAU,CAAC,CAAC;IACxD,CAAC;IACM,yBAAI,GAAX,UAAY,CAAG;QAEX,IAAG,CAAC,YAAY,EAAE,CAAC,IAAI,EACvB;YACI,IAAI,KAAK,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC;YAC7B,KAAI,IAAI,IAAI,IAAI,KAAK,EACrB;gBACI,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAA;aAClC;YACD,IAAG,CAAC,CAAC,kBAAkB,CAAC;gBAAC,CAAC,CAAC,kBAAkB,CAAC,EAAE,CAAC;SACpD;aAED;YACI,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YACtB,IAAG,CAAC,CAAC,MAAM,CAAC;gBAAW,CAAC,CAAC,MAAM,CAAE,CAAC,gBAAgB,EAAE,CAAC;SACxD;QACD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAA;IACvB,CAAC;IAEM,wBAAG,GAAV,UAAW,UAAmB;QAAnB,2BAAA,EAAA,eAAmB;QAE1B,IAAG,IAAI,CAAC,MAAM,CAAC,MAAM,EACrB;YACI,IAAI,EAAE,GAAG,IAAI,CAAC,GAAG,CAAA,CAAC,CAAA,IAAI,CAAC,MAAM,CAAC,GAAG,EAAE,CAAA,CAAC,CAAA,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,CAAA;YACvD,IAAG,EAAE,YAAY,EAAE,CAAC,IAAI,EACxB;gBACI,IAAI,KAAK,GAAG,EAAE,CAAC,aAAa,CAAC,CAAC;gBAC9B,KAAI,IAAI,IAAI,IAAI,KAAK,EACrB;oBACI,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAC,EAAC,UAAU,CAAC,CAAC;iBAC9C;aACJ;iBAED;gBACI,IAAI,CAAC,aAAa,CAAC,EAAE,EAAC,UAAU,CAAC,CAAC;aACrC;YACD,IAAG,CAAC,EAAE,CAAC,WAAW,CAAC;gBAAC,EAAE,CAAC,WAAW,CAAC,GAAC,IAAI,CAAC;YACzC,OAAO,EAAE,CAAC;SACb;QACD,OAAO,IAAI,CAAA;IACf,CAAC;IACM,0BAAK,GAAZ;QAEI,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK;YACrB,IAAG,KAAK,CAAC,SAAS,CAAC;gBAAC,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC;QAC3C,CAAC,CAAC,CAAA;QACF,IAAI,CAAC,MAAM,GAAC,EAAE,CAAA;IAClB,CAAC;IACM,qBAAU,GAAjB,UAAkB,GAAO;QAErB,IAAG,GAAG,CAAC,WAAW,CAAC,EACnB;YACI,GAAG,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SAC9B;IACL,CAAC;IACL,iBAAC;AAAD,CApFA,AAoFC,IAAA","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\frame\\ObjectPool","sourcesContent":["export interface IObpool\r\n{\r\n    unuse(...value);\r\n    reuse(...value);\r\n    recycle(...value);\r\n}\r\nexport interface IOFPool<T> extends IObpool\r\n{\r\n    __factory?:ObjectPool<T>\r\n}\r\nexport default class ObjectPool<T> {\r\n    __pool:T[]=[]\r\n    /**\r\n     * false为弹出第一个true为弹出最后一个\r\n     */\r\n    dir:boolean = false\r\n    /**\r\n     * \r\n     * @param dir 弹出方向\r\n     */\r\n    constructor(dir:boolean = false)\r\n    {\r\n        this.dir=dir\r\n    }\r\n    UnuseCallback(v:any)\r\n    {\r\n        if(v['_poolisload'])\r\n        {\r\n            if(v['unuse'])v['unuse']();\r\n        }\r\n        else\r\n        {\r\n            v['_poolisload']=true;\r\n        }\r\n    }\r\n    ReuseCallback(re:any,reuseValue:any[])\r\n    {\r\n        if(re&&re['reuse'])re['reuse'].apply(re,reuseValue);\r\n    }\r\n    public push(v:T)\r\n    {\r\n        if(v instanceof cc.Node)\r\n        {\r\n            var comps = v['_components'];\r\n            for(var item in comps)\r\n            {\r\n                this.UnuseCallback(comps[item]) \r\n            }\r\n            if(v['removeFromParent'])v['removeFromParent']();\r\n        }\r\n        else\r\n        {\r\n            this.UnuseCallback(v);\r\n            if(v['node'])(<cc.Node>v['node']).removeFromParent();\r\n        }\r\n        this.__pool.push(v)\r\n    }\r\n\r\n    public pop(reuseValue:any[]=[]):T\r\n    {\r\n        if(this.__pool.length)\r\n        {\r\n            var re = this.dir?this.__pool.pop():this.__pool.shift()\r\n            if(re instanceof cc.Node)\r\n            {\r\n                var comps = re['_components'];\r\n                for(var item in comps)\r\n                {\r\n                    this.ReuseCallback(comps[item],reuseValue);\r\n                }\r\n            }\r\n            else\r\n            {\r\n                this.ReuseCallback(re,reuseValue);\r\n            }\r\n            if(!re['__factory'])re['__factory']=this;\r\n            return re;\r\n        }\r\n        return null\r\n    }\r\n    public clear()\r\n    {\r\n        this.__pool.forEach(value=>{\r\n            if(value['destroy'])value['destroy']();\r\n        })\r\n        this.__pool=[]\r\n    }\r\n    static GlobalPush(val:any)\r\n    {\r\n        if(val['__factory'])\r\n        {\r\n            val['__factory'].push(val);\r\n        }\r\n    }\r\n}\r\n"]}