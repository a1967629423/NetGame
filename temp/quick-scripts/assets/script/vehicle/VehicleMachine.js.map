{"version":3,"sources":["VehicleMachine.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\vehicle","sourcesContent":["import { MSM } from \"../../frame/StateMachine/StateMachine\";\r\nimport { MSMDsc } from \"../../frame/StateMachine/StateDec\";\r\nimport SitePeople from \"../site/SitePeople\";\r\nimport { SiteLineSM, SiteSM } from \"../site/SiteMachine\";\r\nimport { SLDSM } from \"../site/SiteLine\";\r\nimport { Path } from \"../Path/PathSM\";\r\n\r\n// Learn TypeScript:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nconst { ccclass, property } = cc._decorator;\r\nconst {mSyncAttachFunc,mSyncFunc}=MSMDsc\r\nexport module Vehicle {\r\n    @MSMDsc.mStateMachine\r\n    @ccclass\r\n    export class VehicleMachine extends MSM.StateMachine {\r\n        static allVehicle:VehicleMachine[] = [];\r\n        @property(SitePeople)\r\n        peoples:SitePeople[] = []\r\n        line:Path.VehiclePath= null\r\n        getNowSite():SiteSM.SiteMachine\r\n        {\r\n            return this.rundir?this.line.lastSite:this.line.nextSite;\r\n        }\r\n        unuse()\r\n        {\r\n            super.unuse();\r\n            var idx = VehicleMachine.allVehicle.findIndex(v=>v===this)\r\n            if(idx!==-1)\r\n            {\r\n                VehicleMachine.allVehicle.splice(idx);\r\n            }\r\n        }\r\n        reuse()\r\n        {\r\n            super.reuse();\r\n            VehicleMachine.allVehicle.push(this);\r\n        }\r\n        nowSite:SiteSM.SiteMachine = null;\r\n        nowProgress:number= 0;\r\n        allLength:number = 0;\r\n        rate:number = 100;\r\n        rundir:boolean = true;\r\n        getNextLine()\r\n        {\r\n            if(this.line)\r\n            {\r\n                return this.rundir?this.line.NextPath:this.line.LastPath;\r\n            }\r\n        }\r\n        getLastLine()\r\n        {\r\n            if(this.line)\r\n            {\r\n                return this.rundir?this.line.NextPath:this.line.LastPath;\r\n            }\r\n        }\r\n        static Factory(line:Path.VehiclePath,progress:number|cc.Vec2,node:cc.Node)\r\n        {\r\n            var vehicle = node.getComponent(VehicleMachine);\r\n            var position:cc.Vec2 = null\r\n            if(progress instanceof cc.Vec2)\r\n            {\r\n                position = progress;\r\n            }\r\n            else\r\n            {\r\n                var result = line.getLocation(progress);\r\n                position = result.position;\r\n            }\r\n            node.position = position;\r\n            vehicle.line = line;\r\n        }\r\n    }\r\n    export class VehicleState extends MSM.State\r\n    {\r\n        context:VehicleMachine\r\n    }\r\n}\r\n\r\n\r\n"]}