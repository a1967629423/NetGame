{"version":3,"sources":["NodeSync.ts"],"names":[],"mappings":";;;;;AAAA,oDAA+C;AAG/C,oBAAoB;AACpB,iFAAiF;AACjF,yFAAyF;AACzF,mBAAmB;AACnB,2FAA2F;AAC3F,mGAAmG;AACnG,8BAA8B;AAC9B,2FAA2F;AAC3F,mGAAmG;AACnG,IAAK,QAEJ;AAFD,WAAK,QAAQ;IACT,6CAAO,CAAA;IAAE,mDAAU,CAAA;IAAE,+CAAQ,CAAA;AACjC,CAAC,EAFI,QAAQ,KAAR,QAAQ,QAEZ;AACK,IAAA,kBAAqC,EAAnC,oBAAO,EAAE,sBAAQ,CAAmB;AAG5C;IAAsC,4BAAY;IADlD;QAAA,qEAwFC;QArFG,cAAQ,GAAY,IAAI,CAAC;QAEzB,kBAAY,GAAa,QAAQ,CAAC,OAAO,CAAC;QAE1C,kBAAY,GAAY,IAAI,CAAC;QAE7B,cAAQ,GAAY,KAAK,CAAC;QAE1B,iBAAW,GAAY,KAAK,CAAC;QAE7B,kBAAY,GAAY,KAAK,CAAC;QAE9B,cAAQ,GAAY,KAAK,CAAC;;IAyE9B,CAAC;IAxEG,yBAAM,GAAN;QACI,QAAQ,IAAI,CAAC,YAAY,EAAE;YACvB,KAAK,QAAQ,CAAC,UAAU;gBACpB,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC;gBACpC,MAAM;YACV,KAAK,QAAQ,CAAC,QAAQ;gBAClB,MAAM;YACV;gBACI,MAAM;SACb;IACL,CAAC;IACD,wBAAK,GAAL;QACI,oBAAoB;QAEpB,oDAAoD;QACpD,4BAA4B;QAC5B,QAAQ;QACR,yJAAyJ;QACzJ,sCAAsC;QACtC,QAAQ;QACR,QAAQ;QACR,IAAI,IAAI,CAAC,WAAW,EAAE;YAClB,IAAI,IAAI,CAAC,YAAY,EAAE;gBACnB,IAAI,CAAC,aAAa,EAAE,CAAC;aACxB;YACD,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACf,IAAI,CAAC,SAAS,EAAE,CAAC;aACpB;SACJ;QACD,IAAI,IAAI,CAAC,YAAY,EAAE;YACnB,IAAI,IAAI,CAAC,YAAY,EAAE;gBACnB,qBAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;aACpE;YACD,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACf,qBAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;aAChE;SACJ;IACL,CAAC;IACD,gCAAa,GAAb;QACI,IAAI,MAAM,GAAI,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;QACpC,IAAI,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE,CAAC;QAC1C,IAAI,EAAE,GAAG,MAAM,CAAC,oBAAoB,CAAC,SAAS,CAAC,qBAAqB,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC;QAC9F,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;QACnD,EAAE,GAAG,IAAI,CAAC;QACV,MAAM,GAAG,IAAI,CAAC;QACd,SAAS,GAAG,IAAI,CAAC;IACrB,CAAC;IACD,4BAAS,GAAT;QACI,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,cAAc,EAAE,CAAC,CAAC;IAC7D,CAAC;IACD,yBAAM,GAAN,UAAO,EAAE;QACL,IAAI,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACpC,IAAI,IAAI,CAAC,YAAY,EAAE;gBACnB,IAAI,CAAC,aAAa,EAAE,CAAC;aACxB;YACD,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACf,IAAI,CAAC,SAAS,EAAE,CAAC;aACpB;SAEJ;IACL,CAAC;IACD,4BAAS,GAAT;QAEI,IAAG,IAAI,CAAC,YAAY,EACpB;YACI,IAAG,qBAAW,CAAC,QAAQ,EACvB;gBACI,qBAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAC,IAAI,CAAC,aAAa,EAAC,IAAI,CAAC,CAAC;gBAChE,qBAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAC,IAAI,CAAC,SAAS,EAAC,IAAI,CAAC,CAAC;aAC/D;SACJ;IACL,CAAC;IApFD;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;8CACO;IAEzB;QADC,QAAQ,CAAC,EAAE,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC;kDACI;IAE1C;QADC,QAAQ;kDACoB;IAE7B;QADC,QAAQ;8CACiB;IAE1B;QADC,QAAQ;iDACoB;IAE7B;QADC,QAAQ;kDACqB;IAE9B;QADC,QAAQ;8CACiB;IAdT,QAAQ;QAD5B,OAAO;OACa,QAAQ,CAuF5B;IAAD,eAAC;CAvFD,AAuFC,CAvFqC,EAAE,CAAC,SAAS,GAuFjD;kBAvFoB,QAAQ","file":"","sourceRoot":"..\\..\\..\\..\\assets\\utility","sourcesContent":["import EventCenter from \"../frame/EventCenter\";\r\n\r\n\r\n// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\nenum SyncEnum {\r\n    disable, mainCamera, mainPlay\r\n}\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class NodeSync extends cc.Component {\r\n    @property(cc.Node)\r\n    tageNode: cc.Node = null;\r\n    @property({ type: cc.Enum(SyncEnum) })\r\n    SyncTypeEnum: SyncEnum = SyncEnum.disable;\r\n    @property\r\n    Synclocation: boolean = true;\r\n    @property\r\n    SyncSize: boolean = false;\r\n    @property\r\n    workInStart: boolean = false;\r\n    @property\r\n    workInResize: boolean = false;\r\n    @property\r\n    negation: boolean = false;\r\n    onLoad() {\r\n        switch (this.SyncTypeEnum) {\r\n            case SyncEnum.mainCamera:\r\n                this.tageNode = cc.Camera.main.node;\r\n                break;\r\n            case SyncEnum.mainPlay:\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n    start() {\r\n        // var _this = this;\r\n\r\n        // GlobalTime.Instantiation.Coroutines((function*(){\r\n        //     while(_this.tageNode)\r\n        //     {\r\n        //         _this.node.position =  _this.node.getParent().convertToNodeSpaceAR(_this.tageNode.getParent().convertToWorldSpaceAR(_this.tageNode.position));\r\n        //         yield CoroutinesType.frame;\r\n        //     }\r\n        // })())\r\n        if (this.workInStart) {\r\n            if (this.Synclocation) {\r\n                this.tracePosition();\r\n            }\r\n            if (this.SyncSize) {\r\n                this.traceSize();\r\n            }\r\n        }\r\n        if (this.workInResize) {\r\n            if (this.Synclocation) {\r\n                EventCenter.Instance.node.on(\"resize\", this.tracePosition, this);\r\n            }\r\n            if (this.SyncSize) {\r\n                EventCenter.Instance.node.on(\"resize\", this.traceSize, this);\r\n            }\r\n        }\r\n    }\r\n    tracePosition() {\r\n        var parent =  this.node.getParent();\r\n        var tarparent = this.tageNode.getParent();\r\n        var po = parent.convertToNodeSpaceAR(tarparent.convertToWorldSpaceAR(this.tageNode.position));\r\n        this.node.position = this.negation ? po.neg() : po;\r\n        po = null;\r\n        parent = null;\r\n        tarparent = null;\r\n    }\r\n    traceSize() {\r\n        this.node.setContentSize(this.tageNode.getContentSize());\r\n    }\r\n    update(dt) {\r\n        if (this.tageNode && !this.workInStart) {\r\n            if (this.Synclocation) {\r\n                this.tracePosition();\r\n            }\r\n            if (this.SyncSize) {\r\n                this.traceSize();\r\n            }\r\n\r\n        }\r\n    }\r\n    onDestroy()\r\n    {\r\n        if(this.workInResize)\r\n        {\r\n            if(EventCenter.Instance)\r\n            {\r\n                EventCenter.Instance.node.off(\"resize\",this.tracePosition,this);\r\n                EventCenter.Instance.node.off(\"resize\",this.traceSize,this);\r\n            }\r\n        }\r\n    }\r\n}\r\n"]}